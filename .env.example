# ════════════════════════════════════════════════════════════════════════════
# RAG Agent — Environment Variables
# Copy this file to the project root as .env and fill in the values.
# ════════════════════════════════════════════════════════════════════════════

# ── LLM provider ────────────────────────────────────────────────────────────
# "openai" (default) or "ollama" for a fully local setup.
# When switching providers, run a Full Sync to re-index with the new embeddings.
LLM_PROVIDER=openai

# ── OpenAI ──────────────────────────────────────────────────────────────────
OPENAI_API_KEY=sk-proj-...
OPENAI_MODEL=gpt-4o-mini
OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# ── Ollama (used when LLM_PROVIDER=ollama) ──────────────────────────────────
# Prerequisites: install Ollama (https://ollama.com) then:
#   ollama pull mistral
#   ollama pull nomic-embed-text
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=mistral
OLLAMA_EMBEDDING_MODEL=nomic-embed-text

# ── SharePoint / MSAL ───────────────────────────────────────────────────────
# Azure AD App Registration — required application permissions (admin consented):
#   Microsoft Graph → Sites.Read.All
#   Microsoft Graph → Files.Read.All
#
# How to create the app registration:
#   1. Azure Portal → Azure Active Directory → App registrations → New registration
#   2. Name: rag-agent  |  Supported account types: Single tenant
#   3. Certificates & secrets → New client secret → copy the VALUE
#   4. API permissions → Add → Microsoft Graph → Application permissions:
#      Sites.Read.All + Files.Read.All → Grant admin consent
#   5. Copy: Directory (tenant) ID, Application (client) ID

SP_TENANT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
SP_CLIENT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
SP_CLIENT_SECRET=your-client-secret-value-here

SP_SITE_HOSTNAME=xxxxxxxxxx.sharepoint.com
SP_SITE_PATH=/sites/xxxxxxxxxxxxxx
SP_DRIVE_NAME=xxxxxxxxxxxxxxxxxxxx

# Comma-separated list of top-level folder names to scan inside the drive.
# Only .pdf, .doc, .docx, .xlsx files inside these folders are indexed.
# Leave empty to scan the entire drive.
# Add more folders by appending them comma-separated.
SP_SCAN_FOLDERS=Infrastructure Knowledge Base,Infrastructure PO

# ── Chroma (vector store) ───────────────────────────────────────────────────
CHROMA_PERSIST_DIR=./data/chroma
CHROMA_COLLECTION_NAME=sharepoint_docs

# ── RAG tuning ──────────────────────────────────────────────────────────────
RETRIEVER_K=6                   # max chunks returned per query
RETRIEVER_SCORE_THRESHOLD=0.5   # min similarity score (0–1); raise to reduce unrelated docs
CHUNK_SIZE=1000                 # characters per chunk
CHUNK_OVERLAP=200               # overlap between adjacent chunks

# ── Sync scheduler ──────────────────────────────────────────────────────────
SYNC_INTERVAL_HOURS=6
DELTA_TOKEN_PATH=./data/delta_token.json

# ── Streamlit app ───────────────────────────────────────────────────────────
APP_TITLE=IT Infrastructure Knowledge Base
APP_PORT=8501

# ── SSL (enterprise proxy) ──────────────────────────────────────────────────
# Set True ONLY when behind a corporate SSL inspection proxy.
# WARNING: disables TLS certificate verification for outbound requests.
INSECURE=False

# ── LangSmith tracing (optional) ────────────────────────────────────────────
LANGSMITH_TRACING=true
LANGSMITH_ENDPOINT=https://api.smith.langchain.com
LANGSMITH_API_KEY=xxxxxxxxxxxxxxxxxxx
LANGSMITH_PROJECT=xxxxxxxxxxxxxxxxxx
